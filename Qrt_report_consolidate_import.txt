Option Explicit

Private Sub Workbook_Open()
    Report.Show
End Sub

Option Explicit

Private Sub clearContent_Click()
clear_sheets
End Sub

Private Sub impButton1_Click()
import_separate_sheets
End Sub

Private Sub impConsolidate_Click()
import_same_sheet
End Sub


Option Explicit

Public Sub import_separate_sheets()
Dim text As Workbook
Dim opened() As Variant
Dim i As Integer
Dim lastr As Integer

opened = Application.GetOpenFilename(Title:="Please select files to import", _
MultiSelect:=True)


Application.ScreenUpdating = False

For i = 1 To Application.CountA(opened)
    Set text = Workbooks.Open(opened(i))
        text.Sheets(1).Range("A1").CurrentRegion.Copy
        Workbooks(1).Activate
        Workbooks(1).Worksheets.Add
        ActiveSheet.Paste
        ActiveSheet.Name = text.Name
        
        Cells.Columns.AutoFit
        
        Application.CutCopyMode = False
        text.Close
Next i

End Sub

Public Sub import_same_sheet()
Dim text As Workbook
Dim opened() As Variant
Dim i As Integer
Dim lastr As Integer

opened = Application.GetOpenFilename(Title:="Please select files to import", _
MultiSelect:=True)

Application.ScreenUpdating = False
Range("a1").Select

For i = 1 To Application.CountA(opened)
    Set text = Workbooks.Open(opened(i))
        text.Sheets(1).Range("A1").Offset(1, 0).CurrentRegion.Copy
        Workbooks(1).Activate
        ActiveSheet.Paste
        'Range("a3000").End(xlUp).Offset(1, 0).Select
        lastr = Application.CountA(Range("A:A"))
        Range("A" & lastr + 1).Select
        Application.CutCopyMode = False
        text.Close
Next i
ActiveSheet.Name = "Consolidated_data"
End Sub

Public Sub clear_sheets()
Dim i As Integer
For i = 1 To Worksheets.Count
    Worksheets(i).Cells.Clear
    Range("A1").Select
Next i
End Sub
