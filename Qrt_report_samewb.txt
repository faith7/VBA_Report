Option Explicit

Private Sub Workbook_Open()
QrtReport.Show
End Sub


Option Explicit

Private Sub AddHeader_Click()
header
End Sub

Private Sub AddSubtotal_Click()
subTotal
End Sub

Private Sub ClearHeader_Click()
clear_header
End Sub

Private Sub ClearReport_Click()
clear_report
End Sub

Private Sub ClearSum_Click()
clear_subtotal
End Sub


Private Sub FinalReport_Click()
final_report
End Sub


Option Explicit

Public Sub final_report()
Dim i As Integer
For i = 1 To Worksheets.Count - 1
    Worksheets(i).Select
    header
    subTotal
    Application.ScreenUpdating = False
    
    Range("A1").CurrentRegion.Copy
    Worksheets("YEARLY REPORT").Select
    Range("A3000").Select
    Selection.End(xlUp).Select
    Selection.Offset(3, 0).Select
    ActiveCell.PasteSpecial
    
    Application.CutCopyMode = False

Next i

Application.ScreenUpdating = True
MsgBox "Quarterly Report created!"

End Sub
Public Sub clear_report()
Worksheets("YEARLY REPORT").Select
Cells.Clear
Range("A1").Select
End Sub
Public Sub clear_header()
Dim i As Integer
If Range("A1") = "Region" Then
    For i = 1 To Worksheets.Count - 1
        Worksheets(i).Select
        Rows("1:1").Delete
    Next i
End If

End Sub

Public Sub clear_subtotal()

Dim i As Integer

For i = 1 To Worksheets.Count - 1
    Worksheets(i).Select
    Range("F3000").Select
    Selection.End(xlUp).Select
   
    If Selection.Offset(0, -1).Value = "" Then
        Selection.Value = ""
    End If
Next i

End Sub
Public Sub header()
' Header Macro
'
    Rows("1:1").Select
    Selection.Insert Shift:=xlDown
    Range("E1").Select
    Selection.End(xlToLeft).Select
    ActiveCell.FormulaR1C1 = "Region"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "Expense"
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "Jan"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = "Feb"
    Range("E1").Select
    ActiveCell.FormulaR1C1 = "Mar"
    Range("F1").Select
    ActiveCell.FormulaR1C1 = "Total"
    Range("A1:F1").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    Selection.Font.Bold = True
End Sub


Public Sub subTotal()
Dim er As String
Dim add As String


Range("F3000").Select
Selection.End(xlUp).Select
er = Selection.Address(False, False)

Selection.Offset(1, 0).Value = "=Sum(F1:" & er & ")"
ActiveCell.Offset(1, 0).Font.Bold = True



End Sub
